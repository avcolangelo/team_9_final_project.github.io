---
title: "About Central Park Squirrels"
output: github_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(tidyverse)
library(plotly)
library(dplyr)


knitr::opts_chunk$set(
  echo = TRUE,
  warning = FALSE,
  fig.width = 8,
  fig.height = 6,
  out.width = "90%"
  )

  options(
    ggplot2.continuous.colour = "viridis",
    ggplot2.continuous.fill = "viridis"
  )
  
  scale_colour_discrete = scale_colour_viridis_d
  scale_fill_discrete = scale_fill_viridis_d
  
  theme_set(theme_minimal() + theme(legend.position = "bottom"))
  
```


```{r wrangle_data, include=FALSE}
squirrel_data =
  read_csv("./data/squirrel_data.csv") %>% 
  janitor::clean_names() %>%
  select(unique_squirrel_id, running, chasing, climbing, eating, foraging) %>%
  mutate(
    running = as.factor(running),
    chasing = as.factor(chasing),
    climbing = as.factor(climbing),
    eating = as.factor(eating),
    foraging = as.factor(foraging),
    running = 
      recode(running, "FALSE" = "no", "TRUE" = "running"),
    chasing =
      recode(chasing, "FALSE" = "no", "TRUE" = "chasing"),
    climbing =
      recode(climbing, "FALSE" = "no", "TRUE" = "climbing"),
    eating =
      recode(eating, "FALSE" = "no", "TRUE" = "eating"),
    foraging =
      recode(foraging, "FALSE" = "no", "TRUE" = "foraging")) %>%
  pivot_longer(
  running:foraging,
 names_to = "activity",
 values_to = "participation") %>%
    mutate(participation = na_if(participation, "no")) %>%
  view
```

```{r behavior_plot, echo=FALSE}
squirrel_plot_data = squirrel_data[!is.na(squirrel_data$participation),] 

squirrel_plot_data <- within(squirrel_plot_data, participation <- factor(participation,levels = names(sort(table(participation),decreasing = TRUE))))

squirrel_plot_data %>%
ggplot(aes(x = participation)) +  geom_bar(fill = "green") + labs(title = "Common Squirrel Behaviors", x = "Behavior", y = "Number of Squirrels Exhibiting Behavior")
```
 